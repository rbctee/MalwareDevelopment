; Author: rbct

; Shellcode (38 bytes):
; "\xeb\x13\x59\x31\xc0\xb0\x04\x31\xdb\x43\x31\xd2\xb2\x0c\xcd\x80\x31\xc0\x40\xcd\x80\xe8\xe8\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x72\x6c\x64\x0a";

global _start

section .text

_start:
    jmp short CallShellcode

Shellcode:
    ; pop the address of the Hello World string inside ecx
    pop ecx
    
    ; print Hello World
    xor eax, eax
    mov al, 0x4

    xor ebx, ebx
    inc ebx

    xor edx, edx
    mov dl, 0xc
    
    ; write syscall
    int 0x80

    ; exit gracefully
    xor eax, eax
    inc eax
    int 0x80

CallShellcode:
    call Shellcode
    message: db "Hello World", 0xa
