import sys

try:
    data = sys.argv[1].replace(r'\x', '')
except:
    print(f"[+] Enter you shellcode as the first argument")
    print(f"[+] Example:")
    print("\t" + r'python3 ./script.py "\xeb\x1a\x31\xc0\x31\xdb\x5e\x88\x46\x07\x89\x46\x08\x89\x46\x0c\x89\xf3\xb0\x0b\x8d..."')
    sys.exit(1)

data = bytes.fromhex(data)
encoded1 = ""
encoded2 = ""
insertion_byte = 0x21

for index, value in enumerate(data):
    b = f"{value:02x}"
    c = f"{insertion_byte:02x}"

    encoded1 += f"0x{b},"
    encoded1 += f"0x{c}"

    encoded2 += f"\\x{b}"
    encoded2 += f"\\x{c}"

    if index != (len(data) -1):
        encoded1 += ","

print("[+] Unencoded shellcode length: %i" % len(data))
print("[+] Encoded shellcode length: %i" % encoded1.count("0x"))

print(encoded1)
print(encoded2)
